<html>
<head>
<title>Real AWS Cost Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<meta http-equiv="refresh" content="5">
</head>

<body>

<h1>Real AWS Cost Dashboard</h1>

<h2>Deployment Details</h2>
<p id="region"></p>
<p id="best"></p>
<p id="saving"></p>
<p id="status"></p>

<h2>Server Usage</h2>
<p id="cpu"></p>
<p id="mem"></p>

<h2>CPU Live Graph</h2>
<canvas id="cpuChart"></canvas>

<script>
let cpuData = [];

async function loadData(){
    const res = await fetch("data.json");
    const data = await res.json();

    document.getElementById("region").innerText =
        "Current Region: " + data.current_region +
        " ($" + data.current_price.toFixed(5) + "/hour)";

    document.getElementById("best").innerText =
        "Best Region: " + data.best_region +
        " ($" + data.best_price.toFixed(5) + "/hour)";

    document.getElementById("saving").innerText =
        "Savings: $" + data.savings.toFixed(5) + "/hour";

    document.getElementById("status").innerText =
        "Status: " + data.status;

    document.getElementById("cpu").innerText =
        "CPU Usage: " + data.cpu + "%";

    document.getElementById("mem").innerText =
        "Memory Usage: " + data.memory + "%";

    cpuData.push(data.cpu);
    if(cpuData.length > 20) cpuData.shift();

    cpuChart.data.labels = cpuData.map((_,i)=>i);
    cpuChart.data.datasets[0].data = cpuData;
    cpuChart.update();
}

const ctx = document.getElementById('cpuChart').getContext('2d');
const cpuChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: [],
        datasets: [{
            label: 'CPU %',
            data: [],
            borderColor: 'red',
            fill: false
        }]
    }
});

setInterval(loadData, 3000);
loadData();
</script>

</body>
</html>